!function(t){var e={};function i(h){if(e[h])return e[h].exports;var n=e[h]={i:h,l:!1,exports:{}};return t[h].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,h){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:h})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var h=Object.create(null);if(i.r(h),Object.defineProperty(h,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(h,n,function(e){return t[e]}.bind(null,n));return h},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=13)}({13:function(t,e,i){"use strict";i.r(e);const h={term:"m",label:["2018/04","2018/05","2018/06","2018/07","2018/08","2018/09","2018/10","2018/11","2018/12","2019/01","2019/02","2019/03","2019/04","2019/05","2019/06","2019/07","2019/08","2019/09","2019/10","2019/11","2019/12","2020/01","2020/02","2020/03","2020/04","2020/05"],value:[10138,8675,6699,7971,9589,9867,11360,8589,8162,7345,6319,6549,7026,8314,10143,-9143,-5259,-4446,-3857,-3100,-2406,2320,6578,3322,2625,845],unit:"億円",name:"営業収益"},n="#ccc",s="#000";var a=class{constructor(t){this.barhMargine=10,this.width=0,this.height=0,this.keisenMargine=50,this.barWidth=0,this.graphwidth=0,this.graphHeight=0,this.rightMargin=0,this.yearLabel="",this.n={x:10,y:10},this._chartContainer=t,this.canvases=[],this.overlay={canvas:document.createElement("canvas"),context:null},this.chart={canvas:document.createElement("canvas"),context:null},this.grid={canvas:document.createElement("canvas"),context:null},this._create()}_create(){this.overlay.context=this.overlay.canvas.getContext("2d"),this.canvases.push(this.overlay.canvas),this.chart.context=this.chart.canvas.getContext("2d"),this.canvases.push(this.chart.canvas),this.grid.context=this.grid.canvas.getContext("2d"),this.canvases.push(this.grid.canvas),this.canvases.reverse(),this.canvases.forEach(t=>{var e;null===(e=this._chartContainer)||void 0===e||e.appendChild(t)}),this.initial(this._chartContainer),this.overlay.canvas.addEventListener("mousemove",t=>{this.drow(t,this.grid.context)})}initial(t){null!=t&&(this.width=t.clientWidth,this.height=t.clientHeight,this.chart.canvas.width=this.width,this.chart.canvas.height=this.height,this.grid.canvas.width=this.width,this.grid.canvas.height=this.height,this.overlay.canvas.width=this.width,this.overlay.canvas.height=this.height,this.graphwidth=this.width-2*this.keisenMargine,this.graphHeight=this.height-2*this.keisenMargine,this.drawBar(h,this.chart.context,this.chart.canvas))}writeYAxis(t,e,i,h){null!=t&&(t.fillStyle="#0063B1",t.font="12px sans-serif",t.textAlign="end",t.fillText(h.toString(),e,i))}drawBar(t,e,i){if(null==e)return;const h=t.label.length;this.barWidth=Math.round(this.graphwidth/h)-this.barhMargine,this.rightMargin=this.width-(this.keisenMargine+(this.barWidth+this.barhMargine)*h-this.barWidth);const n=i.height-this.keisenMargine+20,s=Math.ceil(t.value.reduce((t,e)=>Math.max(t,e))),a=Math.ceil(t.value.reduce((t,e)=>Math.min(t,e))),r=this.makeYaxis(a,s,10);console.log(r);let l=i.height-this.keisenMargine,o=0;for(let t=0;t<r.length;t++)0==r[r.length-t-1]&&(l=this.keisenMargine+Math.ceil(this.graphHeight*(t+1)/r.length)),console.log(`genten:${l} low:${i.height-this.keisenMargine}`),this.drawGentenKeisen(e,this.keisenMargine,l,this.graphwidth),o=this.keisenMargine+Math.ceil(this.graphHeight/r.length)*t;const g=l-this.keisenMargine,c=o-l;for(let i=0;i<h;i++){if(null==this.overlay.context)return;this.overlay.context.fillStyle="red",this.overlay.context.font="12px sans-serif",this.overlay.context.textAlign="left",this.overlay.context.fillText(this.getXlabel(i),this.keisenMargine+1.5*this.barhMargine+(this.barWidth+this.barhMargine)*i,n),e.fillStyle="#81C784",e.fillRect(this.keisenMargine+this.barhMargine+(this.barWidth+this.barhMargine)*i,l,this.barWidth,t.value[i]>=0?-g*t.value[i]/r[r.length-1]:c*t.value[i]/r[0]),this.overlay.context.fillText(t.value[i].toLocaleString(),this.keisenMargine+1.5*this.barhMargine+(this.barWidth+this.barhMargine)*i,t.value[i]>=0?l-g*t.value[i]/r[r.length-1]-10:l+c*t.value[i]/r[0]+20)}}drawGentenKeisen(t,e,i,h){null!=t&&(t.strokeStyle=n,t.strokeStyle=s,t.beginPath(),t.moveTo(e,i),t.lineTo(e,i),t.lineTo(e+h,i),t.stroke())}getXlabel(t){let e="";if("m"==h.term){let i=h.label[t].split("/");this.yearLabel!=i[0]||""==this.yearLabel?(this.yearLabel=i[0],e=i[0]+"年"):e=i[1]+"月"}return e}makeYaxis(t,e,i=10){let h=[];t==e&&(t-=10,e+=10);i<2?i=2:i>2&&(i-=2);let n=(e-t)/i,s=Math.floor(Math.log10(n)),a=Math.pow(10,s),r=Math.floor(n/a+.5)*a,l=r*Math.floor(t/r),o=r*Math.ceil(e/r),g=l;for(;h.push(g),g+=r,!(g>o););return h}drow(t,e){if(null==e)return;e.clearRect(0,0,this.width,this.height),t.offsetX<=this.keisenMargine+this.barhMargine?this.n.x=this.keisenMargine+this.barhMargine:t.offsetX>=this.width-this.rightMargin?this.n.x=this.width-this.rightMargin:this.n.x=Math.floor((t.offsetX-this.keisenMargine)/(this.barWidth+this.barhMargine))*(this.barWidth+this.barhMargine)+(this.keisenMargine+this.barhMargine),t.offsetY<this.keisenMargine?this.n.y=this.keisenMargine:t.offsetY>this.height-this.keisenMargine?this.n.y=this.height-this.keisenMargine:this.n.y=t.offsetY,e.fillStyle="#ccc",e.fillRect(this.n.x,this.keisenMargine,this.barWidth,this.graphHeight);let i=Math.floor((t.offsetX-this.keisenMargine)/(this.barWidth+this.barhMargine));i<0?i=0:i>h.label.length-1&&(i=h.label.length-1),e.fillRect(this.keisenMargine,this.n.y,this.graphwidth,1),e.fillStyle="red",e.font="12px sans-serif",e.textBaseline="bottom",e.fillText(""+this.convertLabel(h.label[i]),this.n.x,this.keisenMargine-24),e.fillText(`${h.value[i].toLocaleString()}${h.unit}`,this.n.x,this.keisenMargine-10)}convertLabel(t){return`${t.split("/")[0]}年${t.split("/")[1]}月`}};window.addEventListener("DOMContentLoaded",(function(){const t=document.getElementById("graph");if(null==t)return;new a(t)}))}});